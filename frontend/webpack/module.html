<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块 | 编程之上</title>
    <meta name="description" content="编程之上，致力于前后端、DevOps 等文章，使各端开发者能够突破瓶颈进一步成长。同时，也记录个人生活，不负芳华。">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.26cb1efd.css" as="style"><link rel="preload" href="/assets/js/app.4c18fba5.js" as="script"><link rel="preload" href="/assets/js/2.e6f4d46e.js" as="script"><link rel="preload" href="/assets/js/6.fddb8c5b.js" as="script"><link rel="prefetch" href="/assets/js/10.5fa34354.js"><link rel="prefetch" href="/assets/js/100.054a5662.js"><link rel="prefetch" href="/assets/js/101.deca23b9.js"><link rel="prefetch" href="/assets/js/102.75feb3b9.js"><link rel="prefetch" href="/assets/js/103.a4153363.js"><link rel="prefetch" href="/assets/js/104.ac48597a.js"><link rel="prefetch" href="/assets/js/105.23885d59.js"><link rel="prefetch" href="/assets/js/106.0a0c08c2.js"><link rel="prefetch" href="/assets/js/107.89e90acb.js"><link rel="prefetch" href="/assets/js/108.52e1bd31.js"><link rel="prefetch" href="/assets/js/109.2a6e0063.js"><link rel="prefetch" href="/assets/js/11.23691164.js"><link rel="prefetch" href="/assets/js/110.aa720c00.js"><link rel="prefetch" href="/assets/js/111.8d3537d1.js"><link rel="prefetch" href="/assets/js/112.3c52f8a4.js"><link rel="prefetch" href="/assets/js/113.6595e4fa.js"><link rel="prefetch" href="/assets/js/114.683278fc.js"><link rel="prefetch" href="/assets/js/115.e2f67236.js"><link rel="prefetch" href="/assets/js/116.0a67d906.js"><link rel="prefetch" href="/assets/js/117.5f7f3075.js"><link rel="prefetch" href="/assets/js/118.01a4229c.js"><link rel="prefetch" href="/assets/js/119.a1eea72c.js"><link rel="prefetch" href="/assets/js/12.6ffe8fd7.js"><link rel="prefetch" href="/assets/js/120.4e8ed9c2.js"><link rel="prefetch" href="/assets/js/121.62293bff.js"><link rel="prefetch" href="/assets/js/122.af0cbd35.js"><link rel="prefetch" href="/assets/js/123.81098794.js"><link rel="prefetch" href="/assets/js/124.dcf282bd.js"><link rel="prefetch" href="/assets/js/125.1f1eb29d.js"><link rel="prefetch" href="/assets/js/126.84037026.js"><link rel="prefetch" href="/assets/js/127.b8f01b64.js"><link rel="prefetch" href="/assets/js/128.e7a837b1.js"><link rel="prefetch" href="/assets/js/129.00e22ca1.js"><link rel="prefetch" href="/assets/js/13.6bae060f.js"><link rel="prefetch" href="/assets/js/130.e0cd0e78.js"><link rel="prefetch" href="/assets/js/131.67d82467.js"><link rel="prefetch" href="/assets/js/132.12479c28.js"><link rel="prefetch" href="/assets/js/133.7aaf937e.js"><link rel="prefetch" href="/assets/js/134.8347b761.js"><link rel="prefetch" href="/assets/js/135.965c1199.js"><link rel="prefetch" href="/assets/js/136.5f41d5d5.js"><link rel="prefetch" href="/assets/js/137.a6bba66f.js"><link rel="prefetch" href="/assets/js/138.ee0eee6f.js"><link rel="prefetch" href="/assets/js/139.3a59b277.js"><link rel="prefetch" href="/assets/js/14.1515e135.js"><link rel="prefetch" href="/assets/js/140.867db40e.js"><link rel="prefetch" href="/assets/js/141.031ba2ab.js"><link rel="prefetch" href="/assets/js/142.61f8fa0f.js"><link rel="prefetch" href="/assets/js/143.2e1efc0c.js"><link rel="prefetch" href="/assets/js/144.bccb1416.js"><link rel="prefetch" href="/assets/js/145.be1ca204.js"><link rel="prefetch" href="/assets/js/146.50a146e6.js"><link rel="prefetch" href="/assets/js/147.dcc0597a.js"><link rel="prefetch" href="/assets/js/148.933147ae.js"><link rel="prefetch" href="/assets/js/149.921df107.js"><link rel="prefetch" href="/assets/js/15.4f5a5421.js"><link rel="prefetch" href="/assets/js/150.3267eaff.js"><link rel="prefetch" href="/assets/js/151.62bf6571.js"><link rel="prefetch" href="/assets/js/152.1d370cec.js"><link rel="prefetch" href="/assets/js/153.165e4d2c.js"><link rel="prefetch" href="/assets/js/154.4138c5a5.js"><link rel="prefetch" href="/assets/js/155.9760d506.js"><link rel="prefetch" href="/assets/js/156.882dded9.js"><link rel="prefetch" href="/assets/js/157.46b74338.js"><link rel="prefetch" href="/assets/js/158.85ccb68f.js"><link rel="prefetch" href="/assets/js/159.f6afb18a.js"><link rel="prefetch" href="/assets/js/16.38b7179c.js"><link rel="prefetch" href="/assets/js/160.5090679f.js"><link rel="prefetch" href="/assets/js/161.a1cb2e7d.js"><link rel="prefetch" href="/assets/js/162.79080b2a.js"><link rel="prefetch" href="/assets/js/163.5b983956.js"><link rel="prefetch" href="/assets/js/164.6b12d4ec.js"><link rel="prefetch" href="/assets/js/165.39b222c3.js"><link rel="prefetch" href="/assets/js/166.f3e43ffd.js"><link rel="prefetch" href="/assets/js/167.b4d1535c.js"><link rel="prefetch" href="/assets/js/168.dd0867ae.js"><link rel="prefetch" href="/assets/js/169.33e13e01.js"><link rel="prefetch" href="/assets/js/17.9a32e9a5.js"><link rel="prefetch" href="/assets/js/170.a2fc407f.js"><link rel="prefetch" href="/assets/js/171.85c643f1.js"><link rel="prefetch" href="/assets/js/172.4d47209f.js"><link rel="prefetch" href="/assets/js/173.d393e674.js"><link rel="prefetch" href="/assets/js/174.8df10b61.js"><link rel="prefetch" href="/assets/js/175.6598c6fe.js"><link rel="prefetch" href="/assets/js/176.4f62e51e.js"><link rel="prefetch" href="/assets/js/177.670e6277.js"><link rel="prefetch" href="/assets/js/178.d3c90a9b.js"><link rel="prefetch" href="/assets/js/179.e024a763.js"><link rel="prefetch" href="/assets/js/18.eb57d49f.js"><link rel="prefetch" href="/assets/js/180.8a65f8e4.js"><link rel="prefetch" href="/assets/js/181.71f07bef.js"><link rel="prefetch" href="/assets/js/182.7585c888.js"><link rel="prefetch" href="/assets/js/183.8c4f9923.js"><link rel="prefetch" href="/assets/js/184.ab741fe4.js"><link rel="prefetch" href="/assets/js/185.7bb43717.js"><link rel="prefetch" href="/assets/js/186.709650c1.js"><link rel="prefetch" href="/assets/js/187.66bb5395.js"><link rel="prefetch" href="/assets/js/188.051e3f95.js"><link rel="prefetch" href="/assets/js/189.767e3da4.js"><link rel="prefetch" href="/assets/js/19.7d5e7e38.js"><link rel="prefetch" href="/assets/js/190.e63a750a.js"><link rel="prefetch" href="/assets/js/191.19f2f975.js"><link rel="prefetch" href="/assets/js/192.07e9f0a1.js"><link rel="prefetch" href="/assets/js/193.7b74236b.js"><link rel="prefetch" href="/assets/js/194.7b0a5a36.js"><link rel="prefetch" href="/assets/js/195.e8b438fc.js"><link rel="prefetch" href="/assets/js/196.549d07c6.js"><link rel="prefetch" href="/assets/js/197.5645e243.js"><link rel="prefetch" href="/assets/js/20.d742c97a.js"><link rel="prefetch" href="/assets/js/21.9e3d84e8.js"><link rel="prefetch" href="/assets/js/22.7be38c4a.js"><link rel="prefetch" href="/assets/js/23.d3d09ebf.js"><link rel="prefetch" href="/assets/js/24.a63d4ca5.js"><link rel="prefetch" href="/assets/js/25.6c3a4141.js"><link rel="prefetch" href="/assets/js/26.e8644b6b.js"><link rel="prefetch" href="/assets/js/27.6dc20c6c.js"><link rel="prefetch" href="/assets/js/28.45e6befc.js"><link rel="prefetch" href="/assets/js/29.13d485ce.js"><link rel="prefetch" href="/assets/js/3.b8c0a42c.js"><link rel="prefetch" href="/assets/js/30.6f9f2068.js"><link rel="prefetch" href="/assets/js/31.e6fe4775.js"><link rel="prefetch" href="/assets/js/32.f5328ac1.js"><link rel="prefetch" href="/assets/js/33.07911484.js"><link rel="prefetch" href="/assets/js/34.cf5bdff1.js"><link rel="prefetch" href="/assets/js/35.ec9ba729.js"><link rel="prefetch" href="/assets/js/36.38632a0b.js"><link rel="prefetch" href="/assets/js/37.e43634c1.js"><link rel="prefetch" href="/assets/js/38.abe24c46.js"><link rel="prefetch" href="/assets/js/39.b2a2c480.js"><link rel="prefetch" href="/assets/js/4.27e79820.js"><link rel="prefetch" href="/assets/js/40.c3cd1b61.js"><link rel="prefetch" href="/assets/js/41.036c16da.js"><link rel="prefetch" href="/assets/js/42.bcf0698d.js"><link rel="prefetch" href="/assets/js/43.4c9f98d2.js"><link rel="prefetch" href="/assets/js/44.40989c71.js"><link rel="prefetch" href="/assets/js/45.ca351f3a.js"><link rel="prefetch" href="/assets/js/46.19967918.js"><link rel="prefetch" href="/assets/js/47.3e6bbc6d.js"><link rel="prefetch" href="/assets/js/48.ef515251.js"><link rel="prefetch" href="/assets/js/49.fcaedd46.js"><link rel="prefetch" href="/assets/js/5.43c70a92.js"><link rel="prefetch" href="/assets/js/50.78e9db1b.js"><link rel="prefetch" href="/assets/js/51.bfe61f51.js"><link rel="prefetch" href="/assets/js/52.4b1c3c51.js"><link rel="prefetch" href="/assets/js/53.c19f8a91.js"><link rel="prefetch" href="/assets/js/54.56b09e53.js"><link rel="prefetch" href="/assets/js/55.4605f4af.js"><link rel="prefetch" href="/assets/js/56.5e33f6c6.js"><link rel="prefetch" href="/assets/js/57.3b8c6e2d.js"><link rel="prefetch" href="/assets/js/58.b1d116ce.js"><link rel="prefetch" href="/assets/js/59.e563b9a2.js"><link rel="prefetch" href="/assets/js/60.fc6f8574.js"><link rel="prefetch" href="/assets/js/61.7c7a016a.js"><link rel="prefetch" href="/assets/js/62.71e365a9.js"><link rel="prefetch" href="/assets/js/63.21193c78.js"><link rel="prefetch" href="/assets/js/64.6282fc8d.js"><link rel="prefetch" href="/assets/js/65.a4b7dc61.js"><link rel="prefetch" href="/assets/js/66.916230b2.js"><link rel="prefetch" href="/assets/js/67.a53ac41e.js"><link rel="prefetch" href="/assets/js/68.8b4ff01e.js"><link rel="prefetch" href="/assets/js/69.ea650b0f.js"><link rel="prefetch" href="/assets/js/7.7c8f2501.js"><link rel="prefetch" href="/assets/js/70.0e68a461.js"><link rel="prefetch" href="/assets/js/71.4e969ee6.js"><link rel="prefetch" href="/assets/js/72.20e0176b.js"><link rel="prefetch" href="/assets/js/73.05558600.js"><link rel="prefetch" href="/assets/js/74.deeb542f.js"><link rel="prefetch" href="/assets/js/75.a66cd6ad.js"><link rel="prefetch" href="/assets/js/76.51cc2506.js"><link rel="prefetch" href="/assets/js/77.dbfe60c6.js"><link rel="prefetch" href="/assets/js/78.3da692f2.js"><link rel="prefetch" href="/assets/js/79.b37669c0.js"><link rel="prefetch" href="/assets/js/8.33f697f5.js"><link rel="prefetch" href="/assets/js/80.a2f901e7.js"><link rel="prefetch" href="/assets/js/81.a2da2ca5.js"><link rel="prefetch" href="/assets/js/82.36aae36f.js"><link rel="prefetch" href="/assets/js/83.dc25d746.js"><link rel="prefetch" href="/assets/js/84.e089d96e.js"><link rel="prefetch" href="/assets/js/85.9bd28009.js"><link rel="prefetch" href="/assets/js/86.b0b1524a.js"><link rel="prefetch" href="/assets/js/87.d129af27.js"><link rel="prefetch" href="/assets/js/88.ac5e2fd5.js"><link rel="prefetch" href="/assets/js/89.55269467.js"><link rel="prefetch" href="/assets/js/9.3a1fbf2b.js"><link rel="prefetch" href="/assets/js/90.5778df13.js"><link rel="prefetch" href="/assets/js/91.227687c6.js"><link rel="prefetch" href="/assets/js/92.4365d88d.js"><link rel="prefetch" href="/assets/js/93.b33b0dc1.js"><link rel="prefetch" href="/assets/js/94.e588b810.js"><link rel="prefetch" href="/assets/js/95.5cf071a2.js"><link rel="prefetch" href="/assets/js/96.fb4aeedd.js"><link rel="prefetch" href="/assets/js/97.891a9789.js"><link rel="prefetch" href="/assets/js/98.a471fddb.js"><link rel="prefetch" href="/assets/js/99.4339e54c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.26cb1efd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">编程之上</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/dva/" class="nav-link">
  Dva
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack/" class="nav-link router-link-active">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/npm/" class="nav-link">
  Npm
</a></li><li class="dropdown-item"><!----> <a href="/frontend/architect/" class="nav-link">
  前端架构
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/frontend/code-style/" class="nav-link">
  代码规范
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nodejs/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/backend/nodejswx/" class="nav-link">
  Node.js 开发微信公众号
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构" class="dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/architect/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/architect/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/architect/setting/" class="nav-link">
  配置
</a></li><li class="dropdown-item"><!----> <a href="/architect/cli/" class="nav-link">
  Cli
</a></li></ul></div></div><div class="nav-item"><a href="/app/" class="nav-link">
  应用
</a></div><div class="nav-item"><a href="/view/" class="nav-link">
  看法
</a></div> <a href="https://github.com/ruizhengyun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/dva/" class="nav-link">
  Dva
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack/" class="nav-link router-link-active">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/npm/" class="nav-link">
  Npm
</a></li><li class="dropdown-item"><!----> <a href="/frontend/architect/" class="nav-link">
  前端架构
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/frontend/code-style/" class="nav-link">
  代码规范
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nodejs/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/backend/nodejswx/" class="nav-link">
  Node.js 开发微信公众号
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构" class="dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/architect/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/architect/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/architect/setting/" class="nav-link">
  配置
</a></li><li class="dropdown-item"><!----> <a href="/architect/cli/" class="nav-link">
  Cli
</a></li></ul></div></div><div class="nav-item"><a href="/app/" class="nav-link">
  应用
</a></div><div class="nav-item"><a href="/view/" class="nav-link">
  看法
</a></div> <a href="https://github.com/ruizhengyun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/webpack/" class="sidebar-link">前言</a></li><li><a href="/frontend/webpack/introduction.html" class="sidebar-link">简介</a></li><li><a href="/frontend/webpack/module.html" class="active sidebar-link">模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#commonjs" class="sidebar-link">CommonJs</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#es6-module" class="sidebar-link">ES6 Module</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#commonjs-与-es6-module" class="sidebar-link">CommonJS 与 ES6 Module</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#循环依赖" class="sidebar-link">循环依赖</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#非模块化文件" class="sidebar-link">非模块化文件</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#amd" class="sidebar-link">AMD</a></li><li class="sidebar-sub-header"><a href="/frontend/webpack/module.html#umd" class="sidebar-link">UMD</a></li></ul></li><li><a href="/frontend/webpack/entry_output.html" class="sidebar-link">从哪儿来到哪儿去</a></li><li><a href="/frontend/webpack/loaders.html" class="sidebar-link">预处理器</a></li><li><a href="/frontend/webpack/style.html" class="sidebar-link">样式处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/webpack/split.html" class="sidebar-link">代码的分片</a></li><li><a href="/frontend/webpack/development.html" class="sidebar-link">开发环境</a></li><li><a href="/frontend/webpack/production.html" class="sidebar-link">生产环境</a></li><li><a href="/frontend/webpack/package_optimization.html" class="sidebar-link">打包优化</a></li><li><a href="/frontend/webpack/package_tools.html" class="sidebar-link">打包工具</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="模块"><a href="#模块" class="header-anchor">#</a> 模块</h1> <h2 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJs</h2> <p>这块标准是在 2009 年提出来的，包含模块、IO、文件等。经过 Node.js 采用并做调整，所以说起 CommonJS 通常是 Node.js 中的版本了。在使用 Node.js 包管理器的年代，CommonJs 成为一颗有流量的明星了。</p> <h3 id="自身作用域"><a href="#自身作用域" class="header-anchor">#</a> 自身作用域</h3> <p>CommonJs 的模块天然有自身的作用域，所有变量和函数声明只能自己访问，外人想都别想，这个保护机制太 nice 了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// order.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'订单系统'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'首页'</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./order.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">------\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="导出机制"><a href="#导出机制" class="header-anchor">#</a> 导出机制</h3> <p>模块对外暴露的方式。对于要暴露的内容可使用 <code>module.exports</code> 来导出，其导出内容格式是一个对象。也可使用简化形式 <code>exports</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module.exports.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'订单系统'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">total</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// exports.js</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'订单系统'</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">total</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面两种所要表达的功能是一样的，内在逻辑是 <code>exports</code> 指向 <code>module.exports</code>，<code>module.exports</code> 是初始化时建的一个空对象。所以<strong>千万不要直接给 <code>exports</code> 赋值，还有 <code>module.exports</code> 和 <code>exports</code> 不要并存</strong>。上面第二个文件 <code>exports.js</code> 可这么来理解：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 初始化（便于理解 exports 与 module.exports 的关系）</span>
<span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
  exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>

<span class="token comment">// exports.js</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'订单系统'</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">total</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="导入机制"><a href="#导入机制" class="header-anchor">#</a> 导入机制</h3> <p>通过 <code>require</code> 导入。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 04/src/order.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块文件 order.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'order name'</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'订单系统'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">total</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'order title'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 04/src/index.js</span>
<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./order.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>title<span class="token punctuation">;</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./order.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">exports.name 能展示么？-------\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">exports.title 能展示么？-------\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> total <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./order.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>total<span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">module.exports 能展示么？</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">total</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'动态加载'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> modulesName <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'product.js'</span><span class="token punctuation">,</span> <span class="token string">'shopcar.js'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
modulesName<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>1.<strong>缓存加载</strong>，第二次导入文件时，无需加载，因为第一次导入已经加载过了，第二次直接使用上次导入的结果；
发现没有？<code>这是 order.js 文件</code> 这个通知在控制台里面只打印了一次，而文件 <code>order.js</code> 实打实的引入了两次。其<strong>原理是</strong>：我们已经知道导出文件有 <code>module</code> 这个对象，我们可能不知道的是这个对象有 <code>loaded</code> 这么个属性（记录模块是否被夹在过），其默认值是 <code>false</code>，即没有加载过。当该模块第一次被加载后，<code>loaded</code> 值会变为 <code>true</code>，所以第二次引入该模块就不会加载该模块了。</p> <p>2.加载模块支持动态加载；</p> <p>3.<code>exports</code> 和 <code>module.exports</code> 不要混合使用，否则 <code>exports</code> 会失效哦；</p> <p><img src="/assets/img/v4.console.bff806b1.png" alt="v4-console"></p> <p>完整代码可<a href="https://github.com/ruizhengyun/webpack-note/tree/master/myapp/04" target="_blank" rel="noopener noreferrer">查看目录 04 =&gt;O(∩_∩)O~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/v4.file.ca712f45.png" alt="v4"></p> <h2 id="es6-module"><a href="#es6-module" class="header-anchor">#</a> ES6 Module</h2> <p>ES6 Module 同样是将每个文件作为一个模块，模块自身有其作用域。所不同的是，引入了关键字 <code>import</code>（导入）和 <code>exports</code> (导出)，例子还是前面的例子，语法糖发生了变化。</p> <h3 id="导出机制-2"><a href="#导出机制-2" class="header-anchor">#</a> 导出机制</h3> <p>1.默认导出，上面例子我们都已接触过了。不过每次只能导出一个，可直接导出对象、字符串、函数等。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 导出字符串</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">'订单系统'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 导出对象，05/src/order.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块文件 order.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'订单系统'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">total</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>2.命名导出，可使用关键字 <code>as</code> 对导出变量重命名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一，05/src/order1.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'订单系统1'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">total</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式二，，05/src/order2.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'订单系统2'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">total</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> total <span class="token keyword">as</span> getTotal <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="导入机制-2"><a href="#导入机制-2" class="header-anchor">#</a> 导入机制</h3> <p>使用关键字 <code>import</code> 导入，也可使用关键字 <code>as</code> 对导入变量重命名，也可使用 <code>as</code> 将导入变量的属性添加到后面对象（<code>order1</code>）中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> total <span class="token keyword">as</span> getProduct <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./order1'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式二</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> order2 <span class="token keyword">from</span> <span class="token string">'./order2'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 05/src/index.js</span>
<span class="token keyword">import</span> order <span class="token keyword">from</span> <span class="token string">'./order'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> total <span class="token keyword">as</span> getProduct <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./order1'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> order2 <span class="token keyword">from</span> <span class="token string">'./order2'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">order.name: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>order<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">order1 getProduct: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getProduct</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">order2 getTotal: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>order2<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/v5.console.8733b790.png" alt="v5-console"></p> <p>完整代码可<a href="https://github.com/ruizhengyun/webpack-note/tree/master/myapp/05" target="_blank" rel="noopener noreferrer">查看目录 05 =&gt;O(∩_∩)O~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/v5.file.c78fe2c1.png" alt="v5"></p> <h2 id="commonjs-与-es6-module"><a href="#commonjs-与-es6-module" class="header-anchor">#</a> CommonJS 与 ES6 Module</h2> <p>两者本质区别在于：<strong>CommonJS 对模块依赖是“动态”的，ES6 Module 是“静态”的</strong>。</p> <p>1.<strong>动态</strong>，模块依赖关系是在代码<strong>运行</strong>阶段</p> <ul><li><code>require</code> 路径可动态指定;</li> <li>支持表达式动判断加载某个模块；</li></ul> <p>2.<strong>静态</strong>，模块依赖关系是在代码<strong>编译</strong>阶段</p> <ul><li>导入、导出语句是声明式的；</li> <li>路径不支持表达式；</li> <li>导入和导出语句必须位于模块的顶层作用域（不能放在 if 语句中）；</li></ul> <h3 id="es6-module-优势"><a href="#es6-module-优势" class="header-anchor">#</a> ES6 Module 优势</h3> <p>咋一看，CommonJS 完美 KO ES6 Module 的方式。可事实并非如此，ES6 Module 这种“静态”方式有优势：</p> <ul><li><strong>僵尸代码检测和排除，减小资源打包体积</strong>。即用静态分析工具检测模块或接口中哪些没有被调用过（比如某个组件只用了部分功能，但有可能所有代码都被加载进来了），这些加载进来未被调用的代码就是僵尸代码。静态分析可以在打包时将这些僵尸代码去掉，减小资源打包体积；</li> <li><strong>编译器优化</strong>，动态模块的导入是一个对象，而 ES6 Module 可直接导入变量，减少引用层级，提高程序效率；</li></ul> <h3 id="值拷贝和动态映射"><a href="#值拷贝和动态映射" class="header-anchor">#</a> 值拷贝和动态映射</h3> <p>场景：导入一个模块时，不同模块模式是不一样的。</p> <ul><li>CommonJS 是值拷贝，可编辑;</li> <li>ES6 Module 是址引用，即映射，只读，即不可编辑；</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 06/src/commonJs.js</span>
<span class="token keyword">let</span> csCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  csCount<span class="token punctuation">,</span>
  <span class="token function-variable function">csCountAdd</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    csCount <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 06/src/es6-module.js</span>
<span class="token keyword">let</span> esCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">esCountAdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  esCount <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> esCount<span class="token punctuation">,</span> esCountAdd <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 06/src/index.js</span>
<span class="token comment">// CommonJS Module</span>
<span class="token keyword">let</span> csCount <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commonJs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>csCount<span class="token punctuation">;</span>
<span class="token keyword">let</span> csCountAdd <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commonJs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>csCountAdd<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----commonjs 初次加载----\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>csCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">csCountAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----commonjs 内部自加 10 -----\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>csCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
csCount <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----commonjs 启动项自加 20------\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>csCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Es6 Module</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> esCount<span class="token punctuation">,</span> esCountAdd <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./es6-module.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----es6 初次加载----\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>esCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">esCountAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----es6 内部自加 10 -----\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>esCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
esCount <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----es6 启动项自加 20------\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>esCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/v6.console.96b36e3f.png" alt="v6-console"></p> <p>通过例子及上图运行结果，可剖析</p> <ul><li>CommonJs 是一份值的拷贝，虽然调用了 <code>csCount()</code>，但是并没有造成在文件 <code>index.js</code> 中副本（<code>csCount</code>）的影响；而副本（<code>csCount</code>）在文件 <code>index.js</code> 中可更改；</li> <li>ES6 是一份值的动态映射，调用了 <code>esCount()</code>，文件 <code>index.js</code> 中副本（<code>esCount</code>）的也随之变化；而副本（<code>esCount</code>）在文件 <code>index.js</code> 中是不可更改，即是只读的；</li></ul> <p>完整代码可<a href="https://github.com/ruizhengyun/webpack-note/tree/master/myapp/06" target="_blank" rel="noopener noreferrer">查看目录 06 =&gt;O(∩_∩)O~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/v6.file.a5801015.png" alt="v6"></p> <h2 id="循环依赖"><a href="#循环依赖" class="header-anchor">#</a> 循环依赖</h2> <p>通常工程中是应该尽量避免这种恶心的循环依赖的产生，因为会带来复杂度。可尽管我们知道这是不好的，也理性地避免发生。但链条长了，业务多了，人员多了，还是不知不觉中“造孽般地”写出这样的代码。</p> <p>场景: A 依赖 B，B 依赖 C，C 依赖 D，D 依赖 A。其实 A 与 B 就互相依赖了。</p> <h3 id="commonjs-module"><a href="#commonjs-module" class="header-anchor">#</a> CommonJs Module</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 07/src/a.js</span>
<span class="token keyword">const</span> fileB <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----- a.js 文件展示 b.js 内容 ------\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> fileB<span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">'这是 a.js 文件'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 07/src/b.js</span>
<span class="token keyword">const</span> fileA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----- b.js 文件展示 a.js 内容 ------\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> fileA<span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">'这是 b.js 文件'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 07/src/index.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们脑海中自运行结果是</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> b<span class="token punctuation">.</span>js 文件展示 a<span class="token punctuation">.</span>js 内容 <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
 这是 a<span class="token punctuation">.</span>js 文件
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> a<span class="token punctuation">.</span>js 文件展示 b<span class="token punctuation">.</span>js 内容 <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
 这是 b<span class="token punctuation">.</span>js 文件
</code></pre></div><p>可控制台是</p> <p><img src="/assets/img/v7.console.c02edc52.png" alt="v7-console"></p> <p>反复检查了代码，没错啊，可本该显示 <code>这是 a.js 文件</code>，为何展示 <code>{}</code>？不行，我还是要好好捋一捋</p> <ul><li>文件 <code>index.js</code> 导入文件 <code>a.js</code>，开始执行文件 <code>a.js</code>，第一行导入文件 <code>b.js</code>，此时进入文件 <code>b.js</code> 内部；</li> <li>文件 <code>b.js</code> 第一行又导入文件 <code>a.js</code>，循环依赖由此产生。这时执行权并没有交回给文件 <code>a.js</code>，而是直接取导出值，此刻文件 <code>a.js</code> 还未执行技结束，导出值就默认为空对象，因此文件 <code>b.js</code> 执行打印语句时，显示 <code>----- b.js 文件展示 a.js 内容 ------ {}</code>;</li> <li>文件 <code>b.js</code> 执行结束了，执行权接着交回给文件 <code>a.js</code>， 文件 <code>a.js</code> 继续执行第二行，然后在控制台打印 <code>----- a.js 文件展示 b.js 内容 ------ 这是 b.js 文件</code>。至此，这个流程结束；</li></ul> <p>完整代码可<a href="https://github.com/ruizhengyun/webpack-note/tree/master/myapp/07" target="_blank" rel="noopener noreferrer">查看目录 07 =&gt;O(∩_∩)O~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/v7.file.41e8de93.png" alt="v7"></p> <h3 id="es6-module-2"><a href="#es6-module-2" class="header-anchor">#</a> ES6 Module</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 08/src/a.js</span>
<span class="token keyword">import</span> fileB <span class="token keyword">from</span> <span class="token string">'./b.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----- a.js 文件展示 b.js 内容 ------\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> fileB<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">'这是 a.js 文件'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 08/src/b.js</span>
<span class="token keyword">import</span> fileA <span class="token keyword">from</span> <span class="token string">'./a.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----- b.js 文件展示 a.js 内容 ------\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> fileA<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">'这是 b.js 文件'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 07/src/index.js</span>
<span class="token keyword">import</span> a <span class="token keyword">from</span> <span class="token string">'./a.js'</span><span class="token punctuation">;</span>
</code></pre></div><p>我们脑海中自运行结果自然也是</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> b<span class="token punctuation">.</span>js 文件展示 a<span class="token punctuation">.</span>js 内容 <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
 这是 a<span class="token punctuation">.</span>js 文件
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> a<span class="token punctuation">.</span>js 文件展示 b<span class="token punctuation">.</span>js 内容 <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
 这是 b<span class="token punctuation">.</span>js 文件
</code></pre></div><p>可控制台是</p> <p><img src="/assets/img/v8.console.1965dd5d.png" alt="v8-console"></p> <p>完整代码可<a href="https://github.com/ruizhengyun/webpack-note/tree/master/myapp/08" target="_blank" rel="noopener noreferrer">查看目录 08 =&gt;O(∩_∩)O~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/v8.file.f6fae538.png" alt="v8"></p> <p>我晕，还是不对，这次不是空对象了，却是 <code>undefined</code>。那循环依赖该如何解决呢？</p> <h2 id="非模块化文件"><a href="#非模块化文件" class="header-anchor">#</a> 非模块化文件</h2> <p>说完 CommonJs 模块和 ES6 Module 形式，有些时候我们还需知道如何处理如 AMD、UMD 这类使用不多的模块。这类模块最常见的就是在 script 标签中引入的 jQuery 及其各种插件。可直接引入，这样会直接执行 <code>jquery.min.js</code>，其接口直接绑定在全局。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'jquery.min.js'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="amd"><a href="#amd" class="header-anchor">#</a> AMD</h2> <p>异步模块定义，Asynchronous Module Definition。社区提出主要是专注于支持浏览器端模块化的标准。与 CommonJS 和 ES6 Module 加载区别在于它的方式是<strong>异步的</strong>。</p> <h3 id="导出"><a href="#导出" class="header-anchor">#</a> 导出</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'getSum'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'calc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'求和'</span><span class="token punctuation">,</span> clac<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>定义模块使用 <code>defined</code>，接收 3 个参数；</li> <li>第 1 个参数是模块 id，即模块名 <code>getSum</code>;</li> <li>第 2 个参数是模块依赖，比如上面模块依赖模块 <code>calc</code>；</li> <li>第 3 个参数是描述模块的导出值，函数或对象；</li></ul> <h3 id="导入"><a href="#导入" class="header-anchor">#</a> 导入</h3> <p>和 CommonJS 导入类似，使用 <code>require</code>，只不过采用的是异步形式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'getSum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">getSum</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token function">getSum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>第 1 个参数是加载模块；</li> <li>第 2 个参数是加载模块后执行的回调函数；</li></ul> <h3 id="优劣势"><a href="#优劣势" class="header-anchor">#</a> 优劣势</h3> <p>模块加载是非阻塞的，即执行到 <code>require</code> 函数不会停止执行后面的代码，也就不会阻塞浏览器。虽然设计思想理念很好，但是写法冗长不易阅读，也易造成回调地狱（callback hell），所以现在 AMD 形式出现的越来越少，更多还是使用 CommonJs 或 ES6 Module 形式。</p> <h2 id="umd"><a href="#umd" class="header-anchor">#</a> UMD</h2> <p>通用模块标准，Universal Module Definition。严格来说，它不能是一种模块标准，而是一组模块的集合。功能是使一个模块能运行在各种环境下（ES6 Module 还未成为正式标准，就没带 ES6 Module 玩）（CommonJS、AMD、非模块化）。看个示例就知道怎么一回事了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">global<span class="token punctuation">,</span> main</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 根据模块环境采用不同的导出机制</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// AMD</span>
    <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// CommonJS</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 非模块化</span>
    global<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 定义模块主体</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>一眼就可以看出，UMD 其本质就是根据当前全局对象中的值判断目前处于何种模块环境。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/10/2020, 1:33:56 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/webpack/introduction.html" class="prev">
        简介
      </a></span> <span class="next"><a href="/frontend/webpack/entry_output.html">
        从哪儿来到哪儿去
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c18fba5.js" defer></script><script src="/assets/js/2.e6f4d46e.js" defer></script><script src="/assets/js/6.fddb8c5b.js" defer></script>
  </body>
</html>
